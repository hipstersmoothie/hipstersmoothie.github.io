<!DOCTYPE html><html><head><meta charSet="utf-8" class="next-head"/><link rel="preload" href="/_next/static/ZCLED0F09LQ8BAoVF9TeS/pages/blog/webpack-images.js" as="script"/><link rel="preload" href="/_next/static/ZCLED0F09LQ8BAoVF9TeS/pages/_app.js" as="script"/><link rel="preload" href="/_next/static/ZCLED0F09LQ8BAoVF9TeS/pages/_error.js" as="script"/><link rel="preload" href="/_next/static/runtime/webpack-042fd1065dc091f35b5c.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.9000cc5c5bacdca8b707.js" as="script"/><link rel="preload" href="/_next/static/runtime/main-c25868fc02f41bb89815.js" as="script"/><div><style id="__jsx-757594817">.stats.jsx-757594817{margin:4em auto 0;}
.link.jsx-757594817 p.jsx-757594817+p.jsx-757594817:hover{color:#e8d0a9;}</style><style id="__jsx-2412815819">.content li{margin-top:0.25em;}
.header.jsx-2412815819{background:#6d929b !important;}
.name.jsx-2412815819{margin-bottom:2em;}
.tabs ul{margin:0 1rem;}</style><style id="__jsx-351074346">body a{color:#73b2d9;}</style><style id="__jsx-3237570666">strong{color:rgba(103,183,246,1) !important;}
pre .hljs{background:initial;}</style><style id="__jsx-69264733">.blogPost.full-blog-post{width:90%;}</style><style id="__jsx-1762840042">.authorImage.jsx-1762840042{border:3px solid #ccc;border-radius:50%;height:60px;left:50%;margin-left:-30px;position:absolute !important;top:-30px;width:60px;}.blogPost.jsx-1762840042{margin:auto auto 65px;max-width:800px;width:100%;margin-top:100px;}.blogTitle.jsx-1762840042{margin-top:1rem !important;margin-bottom:2.5rem;font-size:2rem;font-weight:lighter;line-height:2;line-height:2.5rem;}.blogSubtitle.jsx-1762840042{color:#909aa0;margin-bottom:2rem;}.blogHeader.jsx-1762840042{margin-top:2.5rem;}.blogBody.jsx-1762840042{line-height:1.4;margin:0 1rem 2rem;}@media screen and (min-width:769px){.blogBody.jsx-1762840042{margin:0 4rem 4rem;}}</style></div><div><style id="__jsx-757594817">.stats.jsx-757594817{margin:4em auto 0;}
.link.jsx-757594817 p.jsx-757594817+p.jsx-757594817:hover{color:#e8d0a9;}</style><style id="__jsx-2412815819">.content li{margin-top:0.25em;}
.header.jsx-2412815819{background:#6d929b !important;}
.name.jsx-2412815819{margin-bottom:2em;}
.tabs ul{margin:0 1rem;}</style><style id="__jsx-351074346">body a{color:#73b2d9;}</style><style id="__jsx-3237570666">strong{color:rgba(103,183,246,1) !important;}
pre .hljs{background:initial;}</style><style id="__jsx-69264733">.blogPost.full-blog-post{width:90%;}</style><style id="__jsx-1762840042">.authorImage.jsx-1762840042{border:3px solid #ccc;border-radius:50%;height:60px;left:50%;margin-left:-30px;position:absolute !important;top:-30px;width:60px;}.blogPost.jsx-1762840042{margin:auto auto 65px;max-width:800px;width:100%;margin-top:100px;}.blogTitle.jsx-1762840042{margin-top:1rem !important;margin-bottom:2.5rem;font-size:2rem;font-weight:lighter;line-height:2;line-height:2.5rem;}.blogSubtitle.jsx-1762840042{color:#909aa0;margin-bottom:2rem;}.blogHeader.jsx-1762840042{margin-top:2.5rem;}.blogBody.jsx-1762840042{line-height:1.4;margin:0 1rem 2rem;}@media screen and (min-width:769px){.blogBody.jsx-1762840042{margin:0 4rem 4rem;}}</style></div><meta name="viewport" content="initial-scale=1.0, width=device-width"/><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css" integrity="sha384-5sAR7xN1Nv6T6+dT2mhtzEpVJvfS3NScPQTrOxhwjIuvcA67KV2R5Jz6kr4abQsz" crossOrigin="anonymous"/><link rel="stylesheet" href="https://jenil.github.io/bulmaswatch/default/bulmaswatch.min.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/foundation.min.css"/></head><body><div id="__next"><div class="jsx-351074346 is-fullhd"><section class="jsx-2412815819 hero is-dark header"><div class="jsx-2412815819 hero-body"><div class="jsx-2412815819 container has-text-centered"><div class="jsx-2412815819 level"><div class="jsx-2412815819 level-item"><figure style="width:150px" class="jsx-2412815819 image"><img src="https://avatars2.githubusercontent.com/u/1192452?s=400&amp;v=4" class="jsx-2412815819 is-rounded"/></figure></div></div><h1 class="jsx-2412815819 title name">Hi, I&#x27;m Andrew Lisowski</h1><div class="jsx-757594817 level stats is-mobile"><div class="jsx-757594817 level-item has-text-centered link"><div class="jsx-757594817"><p class="jsx-757594817 heading">GitHub</p><p class="jsx-757594817 title"><a href="https://github.com/hipstersmoothie" target="_blank" rel="noopener noreferrer" class="jsx-757594817"><i class="jsx-757594817 fab fa-github"></i></a></p></div></div><div class="jsx-757594817 level-item has-text-centered link"><div class="jsx-757594817"><p class="jsx-757594817 heading">Twitter</p><p class="jsx-757594817 title"><a href="https://twitter.com/HipsterSmoothie" target="_blank" rel="noopener noreferrer" class="jsx-757594817"><i class="jsx-757594817 fab fa-twitter"></i></a></p></div></div><div class="jsx-757594817 level-item has-text-centered link"><div class="jsx-757594817"><p class="jsx-757594817 heading">Email</p><p class="jsx-757594817 title"><a href="mailto:lisowski54@gmail.com" target="_blank" rel="noopener noreferrer" class="jsx-757594817"><i class="jsx-757594817 far fa-envelope"></i></a></p></div></div><div class="jsx-757594817 level-item has-text-centered link"><div class="jsx-757594817"><p class="jsx-757594817 heading">NPM</p><p class="jsx-757594817 title"><a href="https://www.npmjs.com/~alisowski" target="_blank" rel="noopener noreferrer" class="jsx-757594817"><i class="jsx-757594817 fab fa-npm"></i></a></p></div></div></div></div></div><div class="jsx-2412815819 hero-foot"><nav class="jsx-2412815819 tabs is-boxed is-fullwidth"><ul class="jsx-2412815819"><li class="jsx-2412815819 "><a href="/" class="jsx-2412815819">Overview</a></li><li class="jsx-2412815819 "><a class="jsx-2412815819" href="/projects/">Projects</a></li><li class="jsx-2412815819 is-active"><a class="jsx-2412815819" href="/blog/">Blog</a></li></ul></nav></div></section><article class="jsx-1762840042 card blogPost full-blog-post content"><div class="jsx-1762840042 card-content"><div class="jsx-1762840042 media blogHeader"><div class="jsx-1762840042 media-content has-text-centered"><div style="background-size:cover;background-repeat:no-repeat;position:relative;background-image:url(&#x27;https://avatars2.githubusercontent.com/u/1192452?s=400&amp;v=4&#x27;)" class="jsx-1762840042 image authorImage"></div><h1 class="jsx-1762840042 title blogTitle">Using Webpack and React-Ideal-Image for Buttery Smooth Images</h1><p class="jsx-1762840042 subtitle is-6 blogSubtitle"><a target="_blank" rel="noopener noreferrer" to="https://github.intuit.com/alisowski" href="https://github.intuit.com/alisowski" class="jsx-1762840042">Andrew Lisowski</a><span class="jsx-1762840042"> on <!-- -->June 24, 2018</span></p></div></div><div class="jsx-1762840042 blogBody"><div><p>Images on the webpack have a few drawbacks that take some programming to get around.</p><ul><li>Height and width are unknown — this can cause page jumps and weird layouts</li><li>Blank space while loading</li><li>Large images are slow on old devices or weak internet connections</li><li>The HTML page will download all the images on page load — this can be super slow if you have a lot of images on one page</li></ul><p>Luckily there have been a bunch of web standards made to solve these problems. But navigating them all them and then putting it all together can be daunting.</p><p>Enter React-Ideal-Image. It is a react component that has a bunch of cool functionality built in. Such as: LQIP, WebP, SrcSet, and other UX/features to help you on slow devices. You can read more about all the cool things that went into the component here. But one problem still remains when using this component, how do you generate all the necessary images to make this component really shine?</p><h2>Loading Images with Webpack</h2><p>You probably guessed it by the title, the way we can achieve all this cool functionality is by using Webpack and a few loaders to transform our images at build time!</p><p>First here is a simple configuration that will load the images during the build.</p><pre><code class="hljs language-js" metaString=""><span class="hljs-built_in">module</span>.exports = {
  <span class="hljs-attr">module</span>: {
    <span class="hljs-attr">rules</span>: [
      {
        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/.(gif|png|jpe?g)$/i</span>,
        <span class="hljs-attr">use</span>: [<span class="hljs-string">&#x27;file-loader&#x27;</span>]
      }
    ]
  }
};</code></pre><p>And here is an image rendered with React-Ideal-Image. (right now it doesn’t do anything too cool).</p><pre><code class="hljs language-js" metaString=""><span class="hljs-keyword">import</span> IdealImage <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react-ideal-image&#x27;</span>;
<span class="hljs-keyword">import</span> image <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./goat.png&#x27;</span>;
<span class="hljs-keyword">const</span> ImageComponent = <span class="hljs-function"><span class="hljs-params">props</span> =&gt;</span> {
  &lt;IdealImage
    {...this.props}
    src={image}
    width={<span class="hljs-number">1786</span>}
    height={<span class="hljs-number">1540</span>}
    placeholder={{ <span class="hljs-attr">lqip</span>: image }}
    srcSet={[{ <span class="hljs-attr">width</span>: <span class="hljs-number">1786</span>, <span class="hljs-attr">src</span>: image }]}
  /&gt;;
};</code></pre><p>Okay, so we have an image working and rendering, but we aren’t using any of the cool features! You might notice that we are just using the image for the LQIP image. This doesn’t get us anything and will probably make our app al little slower.</p><h2>LQIP Loader</h2><p>LQIP Loader will take any image and produce a Base64 image string and include it with the src any time you import an object, pretty cool! Let’s see what our config looks like now.</p><pre><code class="hljs language-js" metaString="">{
  <span class="hljs-attr">test</span>: <span class="hljs-regexp">/.(gif|png|jpe?g)$/i</span>,
  <span class="hljs-attr">use</span>: [
    <span class="hljs-string">&#x27;lqip-loader&#x27;</span>
    <span class="hljs-string">&#x27;file-loader&#x27;</span>
  ]
}</code></pre><p>Now in our component when we import an image, we get an object with a path to the original src and the LQIP Base64 string.</p><pre><code class="hljs language-js" metaString=""><span class="hljs-keyword">import</span> IdealImage <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react-ideal-image&#x27;</span>;
<span class="hljs-keyword">import</span> image <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./goat.png&#x27;</span>;
<span class="hljs-keyword">const</span> ImageComponent = <span class="hljs-function"><span class="hljs-params">props</span> =&gt;</span> {
  &lt;IdealImage
    {...this.props}
    src={image.src}
    width={<span class="hljs-number">1786</span>}
    height={<span class="hljs-number">1540</span>}
    placeholder={{ <span class="hljs-attr">lqip</span>: image.preSrc }}
    srcSet={[{ <span class="hljs-attr">width</span>: <span class="hljs-number">1786</span>, <span class="hljs-attr">src</span>: image.src }]}
  /&gt;;
};</code></pre><p>Now as we scroll down the page, React-Ideal-Image will show us the initial LQIP image:</p><p>LQIP Image</p><p>And then once the actual image has downloaded it will show us the real image. So cool!</p><p>Actual Image</p><p>But this image is HUGE! Slow devices will have trouble even with LQIP enabled. And we still have the height and the width hard-coded in the component, not good.</p><h2>Generating srcset</h2><p>srcset allows use to tell the browser about multiple sizes of our image and it decided which on to load based on the size of the device. To accomplish this we need another loader. For this we will use responsive-loader since it has a simple API and works with the LQIP loader.</p><p>We do not need the file-loader anymore because the responsive-loader does this for us. Here I include a few sizes that should cover most devices.</p><pre><code class="hljs language-js" metaString="">{
  <span class="hljs-attr">test</span>: <span class="hljs-regexp">/.(gif|png|jpe?g)$/i</span>,
  <span class="hljs-attr">use</span>: [
    <span class="hljs-string">&#x27;lqip-loader&#x27;</span>
    {
      <span class="hljs-attr">loader</span>: <span class="hljs-string">&#x27;responsive-loader&#x27;</span>,
      <span class="hljs-attr">options</span>: {
        <span class="hljs-attr">sizes</span>: [<span class="hljs-number">300</span>, <span class="hljs-number">600</span>, <span class="hljs-number">900</span>, <span class="hljs-number">1200</span>]
      }
    }
  ]
}</code></pre><p>Now we can pass the generated srcset to React-Ideal-Image. The browser will load the smallest size image suitable for the device.</p><pre><code class="hljs language-js" metaString=""><span class="hljs-keyword">import</span> IdealImage <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react-ideal-image&#x27;</span>;
<span class="hljs-keyword">import</span> image <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./goat.png&#x27;</span>;
<span class="hljs-keyword">const</span> ImageComponent = <span class="hljs-function"><span class="hljs-params">props</span> =&gt;</span> {
  &lt;IdealImage
    {...this.props}
    <span class="hljs-comment">// responsive-loader puts its data in an object</span>
    src={image.src.src}
    width={image.src.height}
    height={image.src.width}
    placeholder={{ <span class="hljs-attr">lqip</span>: image.preSrc }}
    srcSet={image.src.images.map(<span class="hljs-function"><span class="hljs-params">i</span> =&gt;</span> ({
      ...i,
      <span class="hljs-attr">src</span>: i.path
    }))}
  /&gt;;
};</code></pre><p>We’re almost done! All that’s left is to optimize it a little bit.</p><h2>Optimization</h2><p>Some images can be huge but contain very little data. Minifying our images might be able to save us from transferring needlessly large files to the client. To accomplish this lets use image-webpack-loader, which uses imagemin to make the smallest images possible.</p><pre><code class="hljs language-js" metaString="">{
  <span class="hljs-attr">test</span>: <span class="hljs-regexp">/.(gif|png|jpe?g)$/i</span>,
  <span class="hljs-attr">use</span>: [
    <span class="hljs-string">&#x27;lqip-loader&#x27;</span>,
    {
      <span class="hljs-attr">loader</span>: <span class="hljs-string">&#x27;responsive-loader&#x27;</span>,
      <span class="hljs-attr">options</span>: {
        <span class="hljs-attr">sizes</span>: [<span class="hljs-number">300</span>, <span class="hljs-number">600</span>, <span class="hljs-number">900</span>, <span class="hljs-number">1200</span>],
        <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;[path][name]-[width].[ext]&#x27;</span>
      }
    },
    <span class="hljs-string">&#x27;image-webpack-loader&#x27;</span>
  ]
}</code></pre><p>In practice I was able to see some of my images reduce up to 85% in size!</p><h2>Conclusion</h2><p>You can make this component a little more generic and not just render an image of a goat, but anything you pass in. This image is far more useful to the user and creates a smoother loading experience on a range of devices</p></div></div></div></article><footer class="footer"><div class="content has-text-centered"><p>Copyright (c) 2018 Andrew Lisowski. The source code is licensed under<!-- --> <a href="http://opensource.org/licenses/mit-license.php">MIT</a>.</p></div></footer></div></div><script>__NEXT_DATA__ = {"props":{"pageProps":{}},"page":"/blog/webpack-images","query":{},"buildId":"ZCLED0F09LQ8BAoVF9TeS","nextExport":true};__NEXT_LOADED_PAGES__=[];__NEXT_REGISTER_PAGE=function(r,f){__NEXT_LOADED_PAGES__.push([r, f])}</script><script async="" id="__NEXT_PAGE__/blog/webpack-images" src="/_next/static/ZCLED0F09LQ8BAoVF9TeS/pages/blog/webpack-images.js"></script><script async="" id="__NEXT_PAGE__/_app" src="/_next/static/ZCLED0F09LQ8BAoVF9TeS/pages/_app.js"></script><script async="" id="__NEXT_PAGE__/_error" src="/_next/static/ZCLED0F09LQ8BAoVF9TeS/pages/_error.js"></script><script src="/_next/static/runtime/webpack-042fd1065dc091f35b5c.js" async=""></script><script src="/_next/static/chunks/commons.9000cc5c5bacdca8b707.js" async=""></script><script src="/_next/static/runtime/main-c25868fc02f41bb89815.js" async=""></script></body></html>